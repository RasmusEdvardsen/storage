{"remainingRequest":"/home/git/homestorage/homeweb/node_modules/babel-loader/lib/index.js!/home/git/homestorage/homeweb/node_modules/ts-loader/index.js??ref--13-2!/home/git/homestorage/homeweb/src/auth/userWrapper.ts","dependencies":[{"path":"/home/git/homestorage/homeweb/src/auth/userWrapper.ts","mtime":1586434586906},{"path":"/home/git/homestorage/homeweb/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/git/homestorage/homeweb/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/git/homestorage/homeweb/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/git/homestorage/homeweb/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/git/homestorage/homeweb/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/git/homestorage/homeweb/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport { UserAgentApplication } from \"msal\";\nimport { authParams } from \"./authParams\";\nimport { config } from \"./config\";\nimport { error } from \"@/log/log\";\n\nvar UserWrapper = /*#__PURE__*/function () {\n  function UserWrapper() {\n    _classCallCheck(this, UserWrapper);\n\n    this.userAgentApplication = new UserAgentApplication(config);\n  }\n\n  _createClass(UserWrapper, [{\n    key: \"init\",\n    value: function init() {\n      this.userAgentApplication = new UserAgentApplication(config);\n    }\n  }, {\n    key: \"isLoggedIn\",\n    value: function isLoggedIn() {\n      return !!this.userAgentApplication.getAccount();\n    }\n  }, {\n    key: \"account\",\n    value: function account() {\n      if (this.isLoggedIn()) {\n        return this.userAgentApplication.getAccount();\n      }\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      // this.userAgentApplication.logout();\n      // window[config.cache!.cacheLocation!].clear();\n      window.localStorage.clear();\n      window.location.assign(\"https://login.microsoftonline.com/common/oauth2/logout?\" + \"post_logout_redirect_uri=\" + config.auth.redirectUri);\n    }\n  }, {\n    key: \"loginPopup\",\n    value: function loginPopup(callback) {\n      var _this = this;\n\n      this.userAgentApplication.loginPopup(authParams).then(function (_) {\n        _this.userAgentApplication.acquireTokenSilent(authParams).then(function (__) {\n          if (callback) {\n            callback();\n          }\n        }).catch(function (err) {\n          return error(err);\n        });\n      }).catch(function (e) {\n        return error(e);\n      });\n    }\n  }, {\n    key: \"accessToken\",\n    value: function () {\n      var _accessToken = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var tmp;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.userAgentApplication.acquireTokenSilent(authParams);\n\n              case 3:\n                tmp = _context.sent;\n                return _context.abrupt(\"return\", tmp.accessToken);\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", \"\");\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      function accessToken() {\n        return _accessToken.apply(this, arguments);\n      }\n\n      return accessToken;\n    }()\n  }]);\n\n  return UserWrapper;\n}();\n\nexport { UserWrapper as default };",{"version":3,"sources":["/home/git/homestorage/homeweb/src/auth/userWrapper.ts"],"names":[],"mappings":";;;;AAAA,SAAS,oBAAT,QAAqC,MAArC;AACA,SAAS,UAAT;AACA,SAAS,MAAT;AACA,SAAS,KAAT,QAAsB,WAAtB;;IAEqB,W;AAGjB,yBAAA;AAAA;;AACI,SAAK,oBAAL,GAA4B,IAAI,oBAAJ,CAAyB,MAAzB,CAA5B;AACH;;;;2BAEU;AACP,WAAK,oBAAL,GAA4B,IAAI,oBAAJ,CAAyB,MAAzB,CAA5B;AACH;;;iCAEgB;AACb,aAAO,CAAC,CAAC,KAAK,oBAAL,CAA0B,UAA1B,EAAT;AACH;;;8BAEa;AACV,UAAI,KAAK,UAAL,EAAJ,EAAuB;AACnB,eAAO,KAAK,oBAAL,CAA0B,UAA1B,EAAP;AACH;AACJ;;;6BAEY;AACT;AACA;AACA,MAAA,MAAM,CAAC,YAAP,CAAoB,KAApB;AACA,MAAA,MAAM,CAAC,QAAP,CAAgB,MAAhB,CAAuB,4DACnB,2BADmB,GACW,MAAM,CAAC,IAAP,CAAY,WAD9C;AAEH;;;+BAEiB,Q,EAAqB;AAAA;;AACnC,WAAK,oBAAL,CACK,UADL,CACgB,UADhB,EAEK,IAFL,CAEU,UAAC,CAAD,EAAM;AACR,QAAA,KAAI,CAAC,oBAAL,CAA0B,kBAA1B,CAA6C,UAA7C,EACK,IADL,CACU,UAAC,EAAD,EAAO;AAAE,cAAI,QAAJ,EAAc;AAAE,YAAA,QAAQ;AAAK;AAAC,SADjD,EAEK,KAFL,CAEW,UAAC,GAAD;AAAA,iBAAS,KAAK,CAAC,GAAD,CAAd;AAAA,SAFX;AAGH,OANL,EAOK,KAPL,CAOW,UAAC,CAAD;AAAA,eAAO,KAAK,CAAC,CAAD,CAAZ;AAAA,OAPX;AAQH;;;;;;;;;;;;uBAIyB,KAAK,oBAAL,CAA0B,kBAA1B,CAA6C,UAA7C,C;;;AAAZ,gBAAA,G;iDACC,GAAG,CAAC,W;;;;;iDAEJ,E;;;;;;;;;;;;;;;;;;;;;SA7CE,W","sourcesContent":["import { UserAgentApplication } from \"msal\";\nimport { authParams } from \"./authParams\";\nimport { config } from \"./config\";\nimport { error } from \"@/log/log\";\n\nexport default class UserWrapper {\n    public userAgentApplication: UserAgentApplication;\n\n    constructor() {\n        this.userAgentApplication = new UserAgentApplication(config);\n    }\n\n    public init(): void {\n        this.userAgentApplication = new UserAgentApplication(config);\n    }\n\n    public isLoggedIn(): boolean {\n        return !!this.userAgentApplication.getAccount();\n    }\n\n    public account() {\n        if (this.isLoggedIn()) {\n            return this.userAgentApplication.getAccount();\n        }\n    }\n\n    public logout(): void {\n        // this.userAgentApplication.logout();\n        // window[config.cache!.cacheLocation!].clear();\n        window.localStorage.clear();\n        window.location.assign(\"https://login.microsoftonline.com/common/oauth2/logout?\" +\n            \"post_logout_redirect_uri=\" + config.auth.redirectUri);\n    }\n\n    public loginPopup(callback?: () => void): void {\n        this.userAgentApplication\n            .loginPopup(authParams)\n            .then((_) => {\n                this.userAgentApplication.acquireTokenSilent(authParams)\n                    .then((__) => {if (callback) { callback(); }})\n                    .catch((err) => error(err));\n            })\n            .catch((e) => error(e));\n    }\n\n    public async accessToken(): Promise<string> {\n        try {\n            const tmp = await this.userAgentApplication.acquireTokenSilent(authParams);\n            return tmp.accessToken;\n        } catch (error) {\n            return \"\";\n        }\n    }\n}\n"],"sourceRoot":""}]}